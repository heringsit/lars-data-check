{% extends "base.html" %}
{% block content %}
<header class="page-actions" style="margin-top:20px; display:flex; justify-content:flex-start;">
  <a href="{{ back_url }}"
     class="btn"
     style="padding:8px 12px; border:1px solid #d0d7de; border-radius:8px; text-decoration:none; font-weight:600;">
    ← 환자상세로
  </a>
</header>

<h2>운동 기록 상세</h2>

<section class="card" style="margin-bottom:24px;">
  <h3 style="margin:0 0 12px 0;">환자 정보</h3>
  <dl class="kv">
    <dt>이름</dt><dd>{{ patient.name or '-' }}</dd>
    <dt>최신 LARS 점수</dt>
    <dd>{{ patient.lars_score }}{% if patient.lars_date and patient.lars_date != '-' %} ({{ patient.lars_date }}){% endif %}</dd>
    {% if patient.age or patient.sex %}<dt>나이/성별</dt><dd>{{ patient.age or '-' }} / {{ patient.sex or '-' }}</dd>{% endif %}
    {% if patient.registered_on %}<dt>등록일</dt><dd>{{ patient.registered_on }}</dd>{% endif %}
    <dt>기록 날짜</dt><dd>{{ workout_header.date or '-' }}</dd>
    <dt>달성률</dt><dd>{{ workout_header.ratio }} ({{ workout_header.done_sets }}/{{ workout_header.total_sets }} 세트)</dd>
  </dl>
</section>

<section class="card">
  <h3 style="margin:0 0 12px 0;">운동 프로토콜 정보</h3>

  <table class="table" style="width:100%;">
    <thead>
      <tr>
        <th style="width:160px;">운동 분류</th>
        <th>운동명</th>
        <th style="width:120px;">완료 세트</th>
        <th style="width:120px;">총 세트수</th>
        <th style="width:140px;">세트당 동작수</th>
        <th style="width:120px;">휴식(초)</th>
      </tr>
    </thead>
    <tbody>
      {% if details and details|length > 0 %}
        {% for d in details %}
        <tr>
          <td>{{ d.typeName }}</td>
          <td>{{ d.workoutName }}</td>
          <td>{{ d.setNumber }}</td>
          <td>{{ d.setCount }}</td>
          <td>{{ d.countPerSet }}</td>
          <td>{{ d.restTime or '-' }}</td>
        </tr>
        {% endfor %}
      {% else %}
        <tr><td colspan="7" style="text-align:center; color:#777;">해당 일자의 운동 기록이 없습니다</td></tr>
      {% endif %}
    </tbody>
  </table>
</section>
<footer class="page-actions" style="margin-top:20px; display:flex; justify-content:flex-start;">
  <a href="{{ back_url }}" class="btn" style="padding:8px 12px; border:1px solid #d0d7de; border-radius:8px; text-decoration:none; font-weight:600;">← 목록으로</a>
</footer>
{% endblock %}
